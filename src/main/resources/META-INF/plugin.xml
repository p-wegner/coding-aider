<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <!-- Unique identifier of the plugin. It should be FQN. It cannot be changed between the plugin versions. -->
    <id>de.andrena.coding-aider</id>

    <!-- Public plugin name should be written in Title Case.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-name -->
    <name>Coding Aider</name>

    <!-- A displayed Vendor name or Organization ID displayed on the Plugins Page. -->
    <vendor email="peter.wegner@andrena.de" url="https://www.andrena.de">Peter Wegner</vendor>

    <!-- Plugin version -->
    <version>1.0.9-SNAPSHOT</version>

    <!-- Compatibility with IDE builds -->
    <idea-version since-build="232" until-build="242.*"/>

    <!-- Description of the plugin displayed on the Plugin Page and IDE Plugin Manager.
         Simple HTML elements (text formatting, paragraphs, and lists) can be added inside of <![CDATA[ ]]> tag.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-description -->
    <description><![CDATA[
        <p>Seamlessly integrate Aider's AI-powered coding assistance directly into your IDE. This integration boosts your productivity by offering rapid access for precision code generation and refactoring, all while allowing you complete control over the context utilized by the LLM.</p>

        <h3>Important Note</h3>
        <p>To utilize this plugin, you must have a functional Aider installation along with access to API keys for the LLM Providers you intend to use. Alternatively, you can run a local LLM inference server, such as Ollama, to connect to Aider.</p>

        <h3>Key Features</h3>
        <ol>
            <li><strong>AI-Powered Coding Assistance:</strong> Harness the power of Aider to receive intelligent coding assistance within your IDE.</li>
            <li><strong>Intuitive Access:</strong>
                <ul>
                    <li>Quickly initiate Aider actions via the "Start Aider Action" option in the Tools menu or Project View popup menu.</li>
                    <li>Use the keyboard shortcut Alt+A for rapid access.</li>
                    <li>Navigate previous commands with Alt+UP and Alt+DOWN in the message field.</li>
                    <li>Automatically commit all changes with an LLM-generated message using ALT + D</li>
                </ul>
            </li>
            <li><strong>Persistent File Management:</strong> Manage frequently used files for persistent context for Aider operations with Alt+Shift+A, within the Aider Command Window or the Aider Settings.</li>
            <li><strong>Dual Execution Modes:</strong>
                <ul>
                    <li>IDE-based execution for seamless integration.</li>
                    <li>Shell-based execution for users who prefer Aider's rich terminal interaction.</li>
                </ul>
            </li>
            <li><strong>Git Integration:</strong> Automatically launch a Git comparison tool post-Aider operations for easy change review.</li>
            <li><strong>Real-time Progress Tracking:</strong> Monitor Aider command progress through Markdown dialog.</li>
            <li><strong>Multi-File Support:</strong> Execute Aider actions on multiple files or directories while controlling the context provided to Aider from your IDE.</li>
            <li><strong>Webcrawl (Experimental):</strong> Download and convert pages to markdown stored in a .aider-docs folder to add to context.</li>
            <li><strong>Various Specialized Actions:</strong>
                <ul>
                    <li><strong>Commit Action:</strong> Quickly commit changes using Aider.</li>
                    <li><strong>Document Code Action:</strong> Generate markdown documentation for selected files and directories.</li>
                    <li><strong>Fix Compile Error Action:</strong> Fix compile errors using Aider's AI capabilities.</li>
                    <li><strong>Show Last Command Result Action:</strong> Display the result of the last executed Aider command.</li>
                    <li><strong>Settings Action:</strong> Quickly access Aider Settings.</li>
                    <li><strong>Apply Design Pattern Action:</strong> Apply predefined design patterns to selected files or directories.</li>
                    <li><strong>Persistent Files Action:</strong> Manage the list of persistent files for Aider operations.</li>
                </ul>
            </li>
        </ol>

        <h3>Advantages Over Other Coding Assistant Plugins</h3>
        <p>Coding-Aider addresses limitations in existing IntelliJ plugins, particularly for tasks involving multiple file creation or modification. Aider's unique capabilities include:</p>
        <ol>
            <li>Optimized token usage for improved speed (featuring replace edit mode, repo-map, and context control).</li>
            <li>A feature-rich terminal interface for command-line enthusiasts.</li>
            <li>An extensive range of commands to automate common development tasks.</li>
            <li>Robust recovery mechanisms with seamless Git integration.</li>
        </ol>

        <p>Coding-Aider brings these powerful terminal-based features directly into your IDE, leveraging established IDE functionalities like Git integration and keyboard shortcuts.</p>
    ]]></description>

    <!-- Product and plugin compatibility requirements.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-compatibility.html -->
    <depends>com.intellij.modules.platform</depends>
    <depends>org.jetbrains.plugins.terminal</depends>
    <depends>Git4Idea</depends>
    <actions>
        <action id="de.andrena.codingaider.actions.OpenAiderActionGroup"
                class="de.andrena.codingaider.actions.OpenAiderActionGroup"
                text="Open Aider Actions Menu"
                description="Open the Aider Actions menu from anywhere in the IDE">
            <keyboard-shortcut keymap="$default" first-keystroke="alt shift Q"/>
            <add-to-group group-id="MainMenu" anchor="last"/>
        </action>

        <group id="de.andrena.codingaider.AiderActionGroup" text="Aider Actions" popup="true">
            <add-to-group group-id="ProjectViewPopupMenu" anchor="last"/>
            <add-to-group group-id="ToolsMenu" anchor="last"/>

            <action id="de.andrena.codingaider.actions.AiderAction"
                    class="de.andrena.codingaider.actions.AiderAction"
                    text="Start Aider Action"
                    description="This will instruct aider to do something">
                <keyboard-shortcut keymap="$default" first-keystroke="alt A"/>
            </action>
            <action id="de.andrena.codingaider.actions.AiderShellAction"
                    class="de.andrena.codingaider.actions.AiderShellAction"
                    text="Start Aider in Shell Mode"
                    description="This will start aider in shell mode with default settings">
                <keyboard-shortcut keymap="$default" first-keystroke="alt shift D"/>
            </action>
            <action id="de.andrena.codingaider.actions.ShowLastCommandResultAction"
                    class="de.andrena.codingaider.actions.ShowLastCommandResultAction"
                    text="Show Last Aider Command Result"
                    description="Displays the result of the last Aider command">
            </action>
            <separator/>
            <action id="de.andrena.codingaider.actions.DocumentCodeAction"
                    class="de.andrena.codingaider.actions.DocumentCodeAction"
                    text="Document Code with Aider"
                    description="Use Aider to generate documentation for the selected code">
            </action>
            <action id="de.andrena.codingaider.actions.ApplyDesignPatternAction"
                    class="de.andrena.codingaider.actions.ApplyDesignPatternAction"
                    text="Apply Design Pattern with Aider"
                    description="Use Aider to apply a design pattern to the selected code">
                <keyboard-shortcut keymap="$default" first-keystroke="alt P"/>
            </action>
            <separator/>
            <action id="de.andrena.codingaider.CommitAction"
                    class="de.andrena.codingaider.actions.CommitAction"
                    text="Run Aider Commit"
                    description="Run Aider to commit">
                <keyboard-shortcut keymap="$default" first-keystroke="alt D"/>
            </action>
            <separator/>
            <action id="de.andrena.codingaider.actions.PersistentFilesAction"
                    class="de.andrena.codingaider.actions.PersistentFilesAction"
                    text="Add to Persistent Files"
                    description="Add or remove files from the persistent files list">
                <keyboard-shortcut keymap="$default" first-keystroke="alt shift A"/>
            </action>
            <action id="de.andrena.codingaider.actions.AiderWebCrawlAction"
                    class="de.andrena.codingaider.actions.AiderWebCrawlAction"
                    text="Aider Web Crawl"
                    description="Start an Aider web crawl action">
                <keyboard-shortcut keymap="$default" first-keystroke="alt W"/>
            </action>
            <separator/>
            <action id="de.andrena.codingaider.SettingsAction"
                    class="de.andrena.codingaider.actions.SettingsAction"
                    text="Open Aider Settings"
                    description="Open Aider Settings dialog"
                    icon="AllIcons.General.Settings">
            </action>
        </group>

        <!-- Error Fixing Actions -->
        <group id="de.andrena.codingaider.ErrorFixingActions" text="Fix with Aider" popup="true">
            <add-to-group group-id="EditorPopupMenu" anchor="first"/>
            <add-to-group group-id="ProjectViewPopupMenu" anchor="first"/>
            <action id="de.andrena.codingaider.actions.FixCompileErrorAction"
                    class="de.andrena.codingaider.actions.FixCompileErrorAction"
                    text="Fix with Aider (Quick)"
                    description="Use Aider to quickly fix the compile error">
            </action>
            <action id="de.andrena.codingaider.actions.FixCompileErrorInteractive"
                    class="de.andrena.codingaider.actions.FixCompileErrorInteractive"
                    text="Fix with Aider (Interactive)"
                    description="Use Aider to interactively fix the compile error">
            </action>
        </group>
    </actions>

    <!-- Extension points defined by the plugin.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-extension-points.html -->
    <extensions defaultExtensionNs="com.intellij">
        <projectConfigurable
                instance="de.andrena.codingaider.settings.AiderSettingsConfigurable"
                displayName="Aider Settings"
                id="de.andrena.codingaider.settings.AiderSettingsConfigurable"
                parentId="tools"
                nonDefaultProject="true"/>
        <notificationGroup id="Coding Aider Notifications" displayType="BALLOON"/>
        <notificationGroup id="Aider Web Crawl" displayType="BALLOON"/>
        <intentionAction>
            <className>de.andrena.codingaider.actions.FixCompileErrorAction$Intention</className>
            <category>Errors</category>
        </intentionAction>
        <intentionAction>
            <className>de.andrena.codingaider.actions.FixCompileErrorInteractive$Intention</className>
            <category>Errors</category>
        </intentionAction>
    </extensions>
</idea-plugin>
